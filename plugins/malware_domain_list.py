from lib.malware_info_rss_plugin import MalwareInfoRssPlugin
import re

class MalwareDomainList(MalwareInfoRssPlugin):
	def __init__(self):
		"""
		Builds a new object for parsing the Malware Domain List (MDL) rss feed
		"""
		super(MalwareDomainList, self).__init__("http://www.malwaredomainlist.com/hostslist/mdl.xml")
	
	def get_malware_info(self):
		"""
		Returns a formatted list summarizing the latest malware available on the MDL
		"""
		return map(
			lambda entry : dict(
				map(
					lambda summary_line: [
						summary_line.split(": ")[0],summary_line.split(": ")[1]
					],
					re.split(",\s*",entry.summary)
				)
			),
			self.get_rss_entries().entries
		)
		
