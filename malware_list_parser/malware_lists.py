"""
Loads malware plugins from the plugins/ directory
"""

from malware_list_parser.plugins import malware_domain_list
from malware_list_parser.plugins import spyeye_tracker

def load_malware_lists():
	"""
	Returns an array of malware info objects
	"""
	return map(
		lambda plugin_class : plugin_class(),
		malware_list_plugins()
	)

def malware_list_plugins():
	"""
	Returns an array of malware plugin objects
	TODO: retrieve this list dynamically based on classes available in the plugins directory
	"""
	return [
		malware_domain_list.MalwareDomainList,
		spyeye_tracker.SpyEyeTrackerDropUrls,
	]