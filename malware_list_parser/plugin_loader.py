"""
Loads malware plugins from the malware/ directory
"""

from malware_list_parser.plugins import malware_domain_list
from malware_list_parser.plugins import spyeye_tracker

class PluginLoader(object):
	@staticmethod
	def get_malware_info():
		"""
		Returns an array of malware info objects
		"""
		return map(
			lambda plugin_class : plugin_class().get_malware_info(),
			PluginLoader._get_plugins()
		)
	
	@staticmethod
	def _get_plugins():
		"""
		Returns an array of malware plugin objects
		TODO: retrieve this list dynamically based on classes available in the plugins directory
		"""
		return [
			malware_domain_list.MalwareDomainList,
			spyeye_tracker.SpyEyeTrackerDropUrls,
		]